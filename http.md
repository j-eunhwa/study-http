# Real World HTTP

## 1章 - HTTPの基本の4要素
### メソッドとパス
### ヘッダー
### ボディ
### ステータス


## 2章 - ブラウザの基本機能の裏側
### シンプルなフォームの送信（x-www-form-urlencoded）
キーと値は、その間に '=' がある形でキーと値の組になり、 '&' で区切られてエンコードされます。キーや値の英数字以外の文字は、パーセントエンコーディングされます。このため、このタイプはバイナリデータを扱うのには向きません。
```html
<form method="POST">
    <input name="title">
    <input name="author">
    <input type="submit">
</form>
```

### フォームを使ったファイルの送信（multipart/form-data）
ボディは次のようになっています。区切り文字列で2つのブロックに分かれていることが分かります。また、末尾には、区切り文字列 + --という文字列の行があります。それぞれのブロック内も、HTTPのような構成になっており、「ヘッダー + 空行 + コンテンツ」となっています。ヘッダーには、Content-Dispositionという項目が含まれます。Dispositionは気質、性質といった英語で、大雑把にはContent-Typeのようなものです。ここでは、項目名付きでフォームのデータであると宣言しています。

```html
<form action="POST" enctype="multipart/form-data">
</form>
```

### text/plain
www-form-urlencodedに近いのですが、エスケープをせず、改行区切りで値を並べて送信します。

### キャッシュ
毎回ダウンロードしていてはすべて表示するまでにかなりの時間がかかります。すでにダウンロード済みで、内容に変化がなければダウンロードを抑制し、それによってパフォーマンスをあげるメカニズムが「キャッシュ」です。
必要以上にキャッシュされてしまうと、他の人向けのコンテンツが見えてしまうなど、設定を間違えるとセキュリティインシデントに繋がりかねないというリスクを孕んでいる危険な技術でもあります。
- Expires<br>
    更新日時を使ったキャッシュの場合、キャッシュの有効性を確認するために通信が発生します。その通信自体をなくしてしまう仕組みがHTTP/1.0に導入されました。それがExpiresヘッダーです。指定された期日以内の変更がすべて握りつぶされてしまい、新しいコンテンツを見ることが一切できなくなるから、スタイルシートなど、更新がめったに行われない静的コンテンツで使用するのが望ましいです。
- ETag<br>
    ETagはHTTPのレスポンスヘッダーで、リソースの特定バージョンの識別子です。ウェブサーバーは、コンテンツが変更されていない場合はレスポンス全体を再送する必要がないので、キャッシュがより効率的になり通信帯域を節約することができます。
- Cache-Control<br>
    より柔軟なキャッシュ制御をサーバー側から指示できます。Expiresよりも優先されます。
    - サーバーからレスポンスとして送付されるヘッダーについて
        - public → 同一のコンピュータを使う複数ユーザー間でキャッシュを再利用することを許可する
        - private → 同一のコンピュータを使う別のユーザー間でキャッシュを再利用しない。同じURLからユーザーごとに異なるコンテンツが返される場合に利用
        - max-age=n → キャッシュの鮮度を秒で設定。86400を指定すると、1日間はキャッシュが有効で、サーバーに問い合わせることなくキャッシュを利用する。それ以降はサーバーに問い合わせを行い、304 Not Modifiedが返ってきた時のみキャッシュを利用する
        - s-maxage=n → max-ageと同等だが、共有のキャッシュに対する設定値
        - no-cache → キャッシュが有効かどうか毎回サーバーに問い合わせる。max-age=0とほぼ同じ
        - no-store → キャッシュしない
    - クライアント側からリクエストヘッダーで使える設定値
        - no-cache → Pragma: no-cacheと同等
        - no-store → これはレスポンスのno-storeと同じで、プロキシサーバーにキャッシュを削除するように要請
        ‐ max-age → プロキシで保存されているキャッシュが最初に保存してから指定時間以上のキャッシュは使わないようプロキシに要請
        - max-stale → これは指定された時間だけ鮮度維持期間がすぎても、クライアントはそれを受け取ることをプロキシに要請。延長時間は省略でき、その場合は永遠に有効の意味になる
        - min-fresh →鮮度維持期間が指定された時間以上残っていれば、そのキャッシュを送信しても良いとプロキシに要請
        - no-transform → プロキシがコンテンツを改変するのを抑制するようプロキシに要請
        - only-if-cached → キャッシュしている場合のみ応答を返し、そうでなければ504 Gateway Timeoutを送信することをプロキシに要請する。これが設定されると、初回を除いてオリジンサーバーへのアクセスは一切行われない
